# 消息通知

NerChat!是即时聊天软件，即时聊天意味着消息的实时送达，实时展示。这就需要即使Element软件处于后台，也必须保持对新消息的响应。这在桌面端上没有任何问题，只要保持软件处于后台就可以了，我们这里主要聊的是移动端消息通知的问题。

消息通知早已是Android和IOS系统的重要组成部分，在IOS中，如果你可以安装Element IOS，消息通知会完全正常，我们这里主要谈的是安卓端消息通知的问题。

## 安卓手机的消息通知

安卓手机的消息通知方法有两个，一个是FCM，还有一个是后台同步。无论是Element还是Nelement，Google Play版本的软件都支持FCM推送，我们也推荐用户使用FCM推送方法进行通知。作为后备方案，后台同步也是很不错的选择。

无论使用何种方法，在使用之前需要先打开Element/Nelement的通知功能，现在的安卓手机会有很多预设，用户需要手动打开设置中的通知选项，允许软件的所有通知。小米手机还需要额外将Nelement/Element的推送调整成“重要通知”，以防这些通知被系统自动归类为不重要通知而无法抵达。

### FCM

无论是Nelement还是Element，都分为Fdroid版本和Google Play版本。其中，Google Play版本的Element/Nelement支持FCM框架，大多数国产手机在国内[可以无障碍使用](https://www.zhihu.com/question/325953773)FCM，如果想要使用FCM而不是后台驻留推送，可以使用以下方法。

- 检查FCM服务是否可用：打开拨号盘，输入 `*#*#426#*#*` ，在弹出的界面中查看是否出现“Server: Connected”，若是，则手机支持FCM。
- 下载安装Element/Nelement的gplay版本。对Nelement，可以直接在Github Release里下载到。
- 设置-通知-通知方式-Google服务
- 设置-通知-故障诊断-通知故障排除

在“通知故障排除”中，注意“Firebase令牌”一项，这一项必须为“成功获取FCM令牌……”并显示为绿色。
如果这一项失败，说明您的网络不能直接访问Google Play服务获取令牌，请考虑更换一个可以访问到Google Play服务的网络后再尝试。

因此，如果想要正常使用Google Play服务接受通知，则需要有一个可以稳定访问Google Play服务的网络来“通知故障排除”。一旦通知故障排除中没有异常，今后无论您使用什么网络，在任何时候都可以接受到来自Element/Nelement的消息推送。

### 后台同步

如果实在无法使用FCM，还有一个简单的办法就是使用后台同步。后台同步无任何要求，每个安卓手机都可以用这种方法接收推送。打开方法为：设置-通知-通知方式-后台同步。

打开后台同步之后，需要将Element/Nelement的电池优化选项给关闭，允许软件常驻后台，这样软件就可以实时接受推送了。常驻后台会增加电池消耗，因此建议有条件的用户选择FCM方法接收通知。